修改原本的开源代码，变为可用，以及优化写法，
